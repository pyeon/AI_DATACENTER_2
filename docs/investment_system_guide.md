# 📊 데이터센터 투자 자동화 시스템 v2.0 - 종합 가이드

## 📋 목차
1. [개선 사항 요약](#개선-사항-요약)
2. [분석 지표 상세 설명](#분석-지표-상세-설명)
3. [매매 신호 해석 가이드](#매매-신호-해석-가이드)
4. [종목 선정 시스템](#종목-선정-시스템)
5. [실행 방법](#실행-방법)

---

## 🎯 개선 사항 요약

### ✅ 1. Excel 리포트 기능 추가
- **파일명**: `datacenter_report_YYYYMMDD.xlsx`
- **시트 구성**:
  - `종합분석`: 전체 종목 상세 데이터
  - `지표설명서`: 각 지표의 의미와 계산식
  - `대분류별통계`: 카테고리별 성과 요약
  - `투자추천TOP10`: 모멘텀 기반 투자 추천

### ✅ 2. 세부영역 분류 체계 추가
**3단계 분류 체계**:
- **대분류** (Category): AI 인프라, 전력/쿨링, 네트워크, 메모리/스토리지, DC 부동산
- **중분류** (Sector): AI칩, AI서버, 전력, 발전, 쿨링, 네트워크 등
- **세부분류** (Sub-sector): GPU, CPU, 서버제조, HBM메모리 등 15개

### ✅ 3. 추가된 기술적 지표

#### 단기 지표 (1일~1주)
- **RSI (Relative Strength Index)**: 과매수/과매도 판단
- **BB Position (Bollinger Band)**: 변동성 구간 판단
- **Volume Ratio**: 거래량 급증 포착

#### 중기 지표 (1주~1개월)
- **MACD Histogram**: 추세 전환 시점 포착
- **Golden Cross**: 상승 추세 확인
- **Death Cross**: 하락 추세 경고

#### 장기 지표 (3개월 이상)
- **MA200 대비**: 장기 추세 확인
- **3개월 수익률**: 중장기 모멘텀
- **Momentum Score**: 종합 투자 매력도 (0~100점)

### ✅ 4. 통합 매매 신호
각 종목마다 다음 신호를 제공:
- `단기과매도`: RSI < 30 (매수 기회)
- `단기과매수`: RSI > 70 (조정 가능성)
- `중기상승`: MACD 양수 + 골든크로스
- `중기하락`: MACD 음수 + 데드크로스
- `장기상승추세`: MA200 위
- `장기하락추세`: MA200 아래
- `BB하단`: 단기 반등 기회
- `BB상단`: 단기 조정 가능성

### ✅ 5. 종목 자동 선정 시스템
- **실행 주기**: 월 1회
- **선정 기준**: 5가지 항목 100점 만점 평가
- **자동 업데이트**: 각 세부영역별 최고 점수 종목 선정

---

## 📊 분석 지표 상세 설명

### 1️⃣ 수익률 지표

| 지표 | 계산식 | 해석 | 투자 활용 |
|------|--------|------|-----------|
| **1일 수익률** | (현재가 / 전일종가 - 1) × 100 | 단기 변동성 | 당일 시장 심리 파악 |
| **1주 수익률** | (현재가 / 5일전 - 1) × 100 | 단기 추세 | 단기 매매 판단 |
| **1개월 수익률** | (현재가 / 21일전 - 1) × 100 | 중기 추세 | 스윙 투매 판단 |
| **3개월 수익률** | (현재가 / 63일전 - 1) × 100 | 장기 추세 | 포트폴리오 조정 |

**투자 Tip**: 
- 1주 수익률 > 5%: 단기 강세 확인
- 1개월 수익률 > 10%: 중기 상승 추세
- 3개월 수익률 > 20%: 장기 강세 종목

### 2️⃣ 이동평균선 지표

| 지표 | 의미 | 매매 신호 |
|------|------|-----------|
| **MA20 대비** | 단기 이평선 대비 현재가 | +3% 이상: 단기 과열<br>-3% 이하: 단기 침체 |
| **MA60 대비** | 중기 이평선 대비 현재가 | +5% 이상: 중기 강세<br>-5% 이하: 중기 약세 |
| **MA200 대비** | 장기 이평선 대비 현재가 | 양수: 장기 상승<br>음수: 장기 하락 |

**골든크로스 (Golden Cross)**:
- 조건: MA20 > MA60
- 의미: 단기 상승 추세로 전환
- 매매: 매수 타이밍 (특히 거래량 증가 동반 시)

**데드크로스 (Death Cross)**:
- 조건: MA20 < MA60
- 의미: 단기 하락 추세로 전환
- 매매: 매도 또는 관망

### 3️⃣ RSI (Relative Strength Index)

**계산식**: 
```
RS = 14일 평균 상승폭 / 14일 평균 하락폭
RSI = 100 - (100 / (1 + RS))
```

**해석**:
- **70 이상**: 과매수 구간 (조정 가능성 ↑)
- **50~70**: 정상 상승 구간
- **30~50**: 정상 하락 구간
- **30 이하**: 과매도 구간 (반등 기회 ↑)

**투자 전략**:
1. **역추세 매매**: RSI < 30에서 매수, RSI > 70에서 매도
2. **추세 추종**: RSI 40~60 구간 돌파 시 추세 방향 매매
3. **다이버전스**: 가격은 신고가인데 RSI는 하락 → 조정 신호

### 4️⃣ MACD (Moving Average Convergence Divergence)

**계산식**:
```
MACD = EMA(12) - EMA(26)
Signal = EMA(MACD, 9)
Histogram = MACD - Signal
```

**매매 신호**:
- **Histogram > 0**: 상승 모멘텀 (매수 우위)
- **Histogram < 0**: 하락 모멘텀 (매도 우위)
- **MACD 상향돌파 Signal**: 매수 신호
- **MACD 하향돌파 Signal**: 매도 신호

**투자 Tip**:
- 골든크로스 + MACD 양수 = 강력한 매수 신호
- 데드크로스 + MACD 음수 = 강력한 매도 신호

### 5️⃣ 볼린저 밴드 포지션

**계산식**:
```
중심선 = MA(20)
상단밴드 = MA(20) + 2σ
하단밴드 = MA(20) - 2σ
BB Position = (현재가 - 하단) / (상단 - 하단) × 100
```

**해석**:
- **80~100**: 상단 근접 (단기 조정 가능성)
- **50~80**: 정상 상승 구간
- **20~50**: 정상 하락 구간
- **0~20**: 하단 근접 (단기 반등 기회)

**투자 전략**:
- **볼린저 밴드 하단 터치 + RSI < 30**: 강력한 매수 기회
- **볼린저 밴드 상단 돌파**: 강한 상승 추세 (추격 매수 고려)

### 6️⃣ 거래량 비율

**계산식**: (당일 거래량 / 20일 평균 거래량) × 100

**해석**:
- **200% 이상**: 거래량 급증 (주목!)
- **150~200%**: 관심 증가
- **100~150%**: 정상 범위
- **50% 이하**: 관심 감소

**투자 Tip**:
- 거래량 급증 + 상승: 상승 가속화 가능
- 거래량 급증 + 하락: 공포 매도, 반등 기회
- 가격 신고가 + 거래량 감소: 상승 둔화 신호

### 7️⃣ 모멘텀 스코어 (0~100점)

**구성 요소** (각 20점):
1. 1일 수익률 > 0
2. 1주 수익률 > 0
3. 골든크로스
4. RSI 30~70 (과열/침체 아님)
5. MACD Histogram > 0

**해석**:
- **80점 이상**: 매우 강한 모멘텀 (적극 매수)
- **60~80점**: 강한 모멘텀 (매수 고려)
- **40~60점**: 중립 (관망)
- **20~40점**: 약한 모멘텀 (보유 종목 정리 고려)
- **20점 이하**: 매우 약한 모멘텀 (매도 또는 공격적 역추세)

---

## 🎯 매매 신호 해석 가이드

### 📈 매수 신호 (강도순)

#### 🔥 강력한 매수 신호
```
1. RSI < 30 + 골든크로스 + MACD 양수 + 거래량 200%↑
2. BB하단 + RSI < 30 + 3개월 수익률 > 0
3. 모멘텀 스코어 80점 이상 + MA200 위
```

#### ✅ 일반 매수 신호
```
1. 골든크로스 발생 + 거래량 증가
2. RSI 30~40 구간 + MACD 양수 전환
3. BB Position 20~30 + 상승 추세
```

#### ⚠️ 조건부 매수 신호
```
1. RSI < 30 단독 (다른 지표 확인 필요)
2. 골든크로스 단독 (거래량 확인 필요)
3. 3개월 수익률 > 20% (조정 후 재진입 고려)
```

### 📉 매도 신호 (강도순)

#### 🔥 강력한 매도 신호
```
1. RSI > 70 + 데드크로스 + MACD 음수
2. BB상단 + RSI > 70 + 거래량 급증
3. 모멘텀 스코어 20점 이하 + MA200 아래
```

#### ✅ 일반 매도 신호
```
1. 데드크로스 발생 + 거래량 증가
2. RSI 60~70 + MACD 음수 전환
3. BB Position 70~80 + 하락 추세
```

#### ⚠️ 조건부 매도 신호 (일부 매도 고려)
```
1. RSI > 70 단독
2. BB상단 돌파 (강한 추세일 수 있음)
3. 단기 급등 후 (20% 이상)
```

### 🔄 중립/관망 신호
```
1. 모멘텀 스코어 40~60점
2. RSI 40~60
3. MACD Histogram 0 근처
4. BB Position 40~60
```

---

## 🔍 종목 선정 시스템 (월 1회)

### 선정 기준 (100점 만점)

#### 1. 시가총액 (30점)
| 시가총액 | 점수 | 설명 |
|----------|------|------|
| $100B 이상 | 30점 | 초대형주 (안정성 최고) |
| $50B~$100B | 25점 | 대형주 (안정적) |
| $10B~$50B | 20점 | 중대형주 (균형) |
| $5B~$10B | 15점 | 중형주 |
| $1B~$5B | 10점 | 중소형주 |
| $1B 미만 | 5점 | 소형주 (변동성 높음) |

#### 2. 거래량 추세 (20점)
```
거래량 비율 = 최근 20일 평균 / 60일 평균

150% 이상: 20점 (강한 관심)
120% 이상: 15점 (관심 증가)
100% 이상: 10점 (정상)
100% 미만: 5점 (관심 감소)
```

#### 3. 3개월 수익률 (20점)
| 수익률 | 점수 | 해석 |
|--------|------|------|
| +30% 이상 | 20점 | 강한 상승세 |
| +20% 이상 | 17점 | 상승세 |
| +10% 이상 | 14점 | 완만한 상승 |
| 0%~+10% | 10점 | 보합~약한 상승 |
| -10%~0% | 5점 | 약세 |
| -10% 미만 | 0점 | 강한 약세 |

#### 4. 6개월 수익률 (15점)
| 수익률 | 점수 | 해석 |
|--------|------|------|
| +40% 이상 | 15점 | 장기 강세 |
| +25% 이상 | 12점 | 장기 상승 |
| +10% 이상 | 9점 | 완만한 장기 상승 |
| 0%~+10% | 6점 | 보합 |
| -15%~0% | 3점 | 장기 약세 |
| -15% 미만 | 0점 | 강한 장기 약세 |

#### 5. 기술적 지표 (15점)
```
골든크로스: +6점
RSI 40~60 (중립): +6점
RSI 30~70: +3점
현재가 > MA20: +3점
```

### 선정 프로세스

```
[Step 1] 후보 Pool 구성
각 세부영역별로 2~4개 후보 종목 등록

[Step 2] 점수 계산
100점 만점으로 각 종목 평가

[Step 3] 최고점 선정
각 세부영역에서 최고 점수 종목 1개 선정

[Step 4] 결과 저장
Excel 파일로 저장 (selected_stocks_YYYYMMDD.xlsx)

[Step 5] 코드 생성
메인 스크립트에 복사할 STOCKS 리스트 자동 생성
```

### 실행 시기
- **권장**: 매월 1일
- **최소**: 분기별 1회
- **최대**: 월 2회

---

## 🚀 실행 방법

### A. 일일 리포트 (매일 실행)

#### 1. GitHub Actions 설정
```yaml
name: Daily Report
on:
  schedule:
    - cron: '0 6 * * *'  # 매일 한국시간 15시 (미국장 마감 후)

jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'
      - name: Install dependencies
        run: |
          pip install yfinance pandas requests openpyxl
      - name: Run report
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          python datacenter_report_enhanced.py
```

#### 2. 로컬 실행
```bash
# 환경변수 설정
export TELEGRAM_BOT_TOKEN="your_token"
export TELEGRAM_CHAT_ID="your_chat_id"

# 실행
python datacenter_report_enhanced.py
```

### B. 종목 선정 (월 1회 실행)

#### 1. GitHub Actions 설정
```yaml
name: Monthly Stock Selection
on:
  schedule:
    - cron: '0 1 1 * *'  # 매월 1일 10시

jobs:
  selection:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'
      - name: Install dependencies
        run: |
          pip install yfinance pandas openpyxl
      - name: Run selection
        run: |
          python stock_selection_system.py
```

#### 2. 로컬 실행
```bash
python stock_selection_system.py
```

#### 3. 결과 적용
```bash
# 1. selected_stocks_YYYYMMDD.xlsx 열기
# 2. 출력된 STOCKS 리스트 복사
# 3. datacenter_report_enhanced.py의 STOCKS 변수에 붙여넣기
# 4. 다음 달 일일 리포트에 자동 반영
```

---

## 📱 텔레그램 메시지 예시

### 개선 전
```
📊 데이터센터 종목 일일 리포트
🕐 2025-11-12 15:00

🔥 오늘 상승 TOP 5
🚀 NVIDIA: +5.79%
...

⭐ 골든크로스 (25개)
• NVIDIA
• AMD
...
```

### 개선 후
```
📊 데이터센터 종목 일일 리포트
🕐 2025-11-12 15:00
━━━━━━━━━━━━━━━

🔥 오늘 상승 TOP 5
🚀 NVIDIA (GPU): +5.79%
🚀 SK hynix (HBM메모리): +6.44%
...

⭐ 골든크로스 (25개)
• NVIDIA (GPU)
• AMD (GPU)
...

💪 강한 모멘텀 (8개)
• NVIDIA: 95점
• Broadcom: 88점
...

🎯 RSI 과매도 (매수기회)
• Intel: RSI 28.5
...

📂 대분류별 현황
• AI 인프라: 4/5개 상승 (평균 +3.2%)
• 전력/쿨링: 5/7개 상승 (평균 +1.8%)
...

━━━━━━━━━━━━━━━
📈 상승: 23개
📉 하락: 3개
📊 총 26개 종목
📁 Excel: datacenter_report_20251112.xlsx
```

---

## 💡 투자 활용 가이드

### 단기 매매 (1일~1주)
**참고 지표**:
1. 1일 수익률
2. RSI
3. BB Position
4. 거래량 비율

**전략**:
- RSI < 30 + BB하단 → 매수
- RSI > 70 + BB상단 → 매도
- 거래량 200%↑ + 상승 → 추격 매수

### 중기 매매 (1주~1개월)
**참고 지표**:
1. 골든/데드크로스
2. MACD Histogram
3. 1개월 수익률
4. 모멘텀 스코어

**전략**:
- 골든크로스 + MACD 양수 → 매수
- 모멘텀 80점↑ → 보유 강화
- 데드크로스 발생 → 매도

### 장기 투자 (3개월 이상)
**참고 지표**:
1. MA200 대비
2. 3개월 수익률
3. 대분류별 통계
4. 종합 매매신호

**전략**:
- MA200 위 + 3개월 +20%↑ → 장기 보유
- 대분류 평균 > 종목 수익률 → 교체 검토
- 투자추천 TOP10 분산 투자

---

## ⚠️ 주의사항

1. **과최적화 경계**: 모든 지표가 완벽할 때만 매매하지 말 것
2. **손절 원칙**: -7~10% 손절 라인 설정
3. **분산 투자**: 한 종목에 30% 이상 집중 금지
4. **대분류 균형**: 각 대분류에서 1~2종목씩 분산
5. **정기 리밸런싱**: 월 1회 포트폴리오 점검

---

## 📞 문의 및 개선 제안

기능 개선이나 버그 리포트는 GitHub Issue로 남겨주세요.

**Happy Investing! 📈💰**
